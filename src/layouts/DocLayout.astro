---
import MainLayout from './MainLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import { getLangFromUrl, useTranslations } from '../i18n/utils';

// 1. DÃ©finition de la structure pour TypeScript
interface Props {
  title: string;
  description?: string;
  sections: { title: string; link: string }[]; // On dit que c'est un tableau d'objets
}

const { title, description, sections } = Astro.props;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const isRTL = lang === 'ar';

const base = '/fordima-academy';
---

<MainLayout title={title} description={description}>
  <Navbar slot="header" />

  <div class="k-container k-mt-4">
    <div class="k-row">
      <aside class={`k-col-md-3 k-mb-4 ${isRTL ? 'k-order-md-2' : ''}`}>
        <div class="sidebar-content k-p-3" style="background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0; position: sticky; top: 20px;">
          <h5 class="k-h5 k-mb-3 k-text-primary">{t('doc.menu') || 'Menu'}</h5>
          <ul style="list-style: none; padding: 0;">
            {sections.map((section) => (
              <li class="k-mb-2">
                <a 
                  href={`${base}/${lang}/docs/${section.link}`} 
                  class="k-text-decoration-none doc-link"
                  style="color: #475569; font-size: 0.95rem; transition: 0.3s; display: block;"
                >
                  {section.title}
                </a>
              </li>
            ))}
          </ul>
        </div>
      </aside>

      <article class={`k-col-md-9 k-mb-5 ${isRTL ? 'k-order-md-1' : ''}`}>
        <div class="k-card k-p-4" style="border: none; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <slot /> 
        </div>
      </article>
    </div>
  </div>

  <Footer slot="footer" />
</MainLayout>

<style>
  .doc-link:hover {
    color: #2563eb !important;
    transform: translateX(5px);
  }

  :global([dir="rtl"]) .doc-link:hover {
    transform: translateX(-5px);
  }
  
  article :global(h1) { color: #0f172a; margin-bottom: 1.5rem; font-size: 2rem; }
  article :global(h2) { color: #1e293b; margin-top: 2rem; border-bottom: 1px solid #eee; padding-bottom: 0.5rem; }
  article :global(pre) { background: #1e293b; color: #fff; padding: 1.2rem; border-radius: 8px; overflow-x: auto; margin: 1.5rem 0; }
  article :global(code) { background: #f1f5f9; padding: 2px 5px; border-radius: 4px; color: #e11d48; font-family: monospace; }
  article :global(p) { margin-bottom: 1.2rem; line-height: 1.7; }
</style>