---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const base = '/fordima-academy';

// Liste des langues pour le sÃ©lecteur (pourrait aussi Ãªtre dans ui.ts)
const languages = [
  { code: 'en', label: 'EN', flag: 'ðŸ‡¬ðŸ‡§' },
  { code: 'fr', label: 'FR', flag: 'ðŸ‡«ðŸ‡·' },
  { code: 'es', label: 'ES', flag: 'ðŸ‡ªðŸ‡¸' },
  { code: 'ar', label: 'AR', flag: 'ðŸ‡¸ðŸ‡¦' }
];
---

<nav class="k-navbar k-glass">
  <div class="k-container k-d-flex k-align-center k-justify-between">
    <a href={`${base}/${lang}/`} class="k-logo k-d-flex k-align-center">
      <img 
        src={`${base}/logo-fordima.png`} 
        alt="Fordima Logo" 
        style="height: 60px;"
      />
      <span class="k-ml-2 k-d-none k-d-md-inline-block">
        FORDIMA <span class="k-text-primary">ACADEMY</span>
      </span>
    </a>

    <div class="k-d-flex k-align-center">
      <ul class="k-nav-links k-mr-4" id="main-menu">
        <li><a href={`${base}/${lang}/docs/`}>{t('nav.docs')}</a></li>
        <li><a href="#books">{t('nav.books')}</a></li>
        
        <li class="k-ml-2">
            <select 
                onchange="window.location.pathname = this.value" 
                class="lang-select"
            >
                {languages.map((l) => (
                    <option 
                        value={`${base}/${l.code}/`} 
                        selected={lang === l.code}
                    >
                        {l.flag} {l.label}
                    </option>
                ))}
            </select>
        </li>
      </ul>

      <a href="https://github.com/fomadev" class="k-btn k-btn-primary k-btn-sm" target="_blank">
        {t('nav.github')}
      </a>

      <button class="k-burger k-ml-2" data-kitoko="burger" data-target="#main-menu">
        â˜°
      </button>
    </div>
  </div>
</nav>

<style>
    .k-glass {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.8) !important;
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e2e8f0;
    }

    .lang-select {
        padding: 5px 10px;
        border-radius: 20px;
        border: 1px solid #e2e8f0;
        background: white;
        cursor: pointer;
        font-size: 0.85rem;
        outline: none;
    }

    .lang-select:hover {
        border-color: #2563eb;
    }

    /* Inversion des marges pour l'Arabe */
    :global([dir="rtl"]) .k-ml-2 {
        margin-left: 0 !important;
        margin-right: 0.5rem !important;
    }
    :global([dir="rtl"]) .k-mr-4 {
        margin-right: 0 !important;
        margin-left: 1.5rem !important;
    }
</style>